<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Cross-cutting concepts</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Cross-cutting concepts</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_domain_concepts">Domain concepts</a>
<ul class="sectlevel2">
<li><a href="#_domain_entity_model">Domain entity model</a></li>
<li><a href="#_domain_model">Domain model</a></li>
<li><a href="#_api_model">API Model</a></li>
<li><a href="#_jobstatus">JobStatus</a></li>
<li><a href="#_job_store_datamodel">Job Store Datamodel</a></li>
<li><a href="#_job_response_datamodel">Job Response Datamodel</a></li>
</ul>
</li>
<li><a href="#_safety_and_security_concepts">Safety and security concepts</a>
<ul class="sectlevel2">
<li><a href="#_authentication_authorization">Authentication / Authorization</a></li>
<li><a href="#_credentials">Credentials</a></li>
</ul>
</li>
<li><a href="#_architecture_and_design_patterns">Architecture and design patterns</a>
<ul class="sectlevel2">
<li><a href="#_dependency_inversion">Dependency inversion</a></li>
<li><a href="#_hexagonal_architecture">Hexagonal architecture</a></li>
</ul>
</li>
<li><a href="#_under_the_hood_concepts">"Under-the-hood" concepts</a>
<ul class="sectlevel2">
<li><a href="#_persistence">Persistence</a></li>
<li><a href="#_transaction_handling">Transaction handling</a></li>
<li><a href="#_session_handling">Session handling</a></li>
<li><a href="#_communication_and_integration">Communication and integration</a></li>
<li><a href="#_exception_and_error_handling">Exception and error handling</a></li>
<li><a href="#_parallelization_and_threading">Parallelization and threading</a></li>
<li><a href="#_plausibility_checks_and_validation">Plausibility checks and validation</a></li>
<li><a href="#_policy_store">Policy Store</a></li>
<li><a href="#_digital_twin_edc_requirements">Digital Twin / EDC requirements</a></li>
<li><a href="#_caching">Caching</a></li>
<li><a href="#_discovery_process">Discovery Process</a></li>
</ul>
</li>
<li><a href="#_development_concepts">Development concepts</a>
<ul class="sectlevel2">
<li><a href="#_build_test_deploy">Build, test, deploy</a></li>
<li><a href="#_code_generation">Code generation</a></li>
<li><a href="#_migration">Migration</a></li>
<li><a href="#_configurability">Configurability</a></li>
</ul>
</li>
<li><a href="#_operational_concepts">Operational concepts</a>
<ul class="sectlevel2">
<li><a href="#_administration">Administration</a></li>
<li><a href="#_disaster_recovery">Disaster-Recovery</a></li>
<li><a href="#_scaling">Scaling</a></li>
<li><a href="#_clustering">Clustering</a></li>
<li><a href="#_logging">Logging</a></li>
<li><a href="#_monitoring">Monitoring</a></li>
</ul>
</li>
<li><a href="#_testing_concepts">Testing concepts</a>
<ul class="sectlevel2">
<li><a href="#_how_to_test_a_feature">How to test a feature</a></li>
<li><a href="#_umbrella">Umbrella</a></li>
</ul>
</li>
<li><a href="#_api_documentation">API Documentation</a>
<ul class="sectlevel2">
<li><a href="#_table_of_contents">Table of Contents</a></li>
<li><a href="#_ess_endpoints">ESS Endpoints</a></li>
<li><a href="#_irs_endpoints">IRS Endpoints</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_domain_concepts">Domain concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_domain_entity_model">Domain entity model</h3>
<div class="imageblock">
<div class="content">
<img src="domain-entity-model.svg" alt="domain entity model" width="2747" height="1146">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_domain_model">Domain model</h3>
<div class="imageblock">
<div class="content">
<img src="domain-model.svg" alt="domain model" width="2045" height="646">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_api_model">API Model</h3>
<div class="paragraph">
<p>For detailed information about the API model, please refer to the <a href="https://eclipse-tractusx.github.io/item-relationship-service/docs/api-specification/api-specification.html">API specification</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jobstatus">JobStatus</h3>
<div class="paragraph">
<p>A job can be in one of the following states:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">State</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNSAVED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The job was created, but not yet stored by the system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INITIAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The job was stored by the system and is now queued for processing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IN_PROGRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The job is currently being processed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TRANSFERS_FINISHED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All transfers for the job have been finished, and it is now being finalized.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMPLETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The job has completed. See the job response for details on the data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The job could not be processed correctly by the IRS due to a technical problem.</p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="job-state-machine.svg" alt="job state machine" width="1533" height="282">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_job_store_datamodel">Job Store Datamodel</h3>
<div class="imageblock">
<div class="content">
<img src="inmemory-model.svg" alt="inmemory model" width="2144" height="294">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_job_response_datamodel">Job Response Datamodel</h3>
<div class="imageblock">
<div class="content">
<img src="job-response-model.svg" alt="job response model" width="3567" height="866">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_safety_and_security_concepts">Safety and security concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_authentication_authorization">Authentication / Authorization</h3>
<div class="sect3">
<h4 id="_irs_api">IRS API</h4>
<div class="paragraph">
<p>The IRS API is secured using API Keys (tokens that a client provides when invoking API calls). IRS identifies API clients based on the provided token inside 'X-API-KEY' request header, and then checks the token with configuration. API Keys can be configured with helm configuration entries - check Administration Guide to know how to do this. Every request to the IRS API requires a valid 'X-API-KEY' header to be successfully authenticated.</p>
</div>
<div class="paragraph">
<p>Currently, IRS API handles two roles: <strong>'admin_irs'</strong> and <strong>'view_irs'.</strong> A valid token with the <strong>'admin_irs'</strong> role can access any endpoint exposed by the IRS API, including Policies management API. A valid token with the <strong>'view_irs'</strong> role does not have access to policies endpoints.
This behavior is shown in the table below.</p>
</div>
<div class="sect4">
<h5 id="_rights_and_roles_matrix_of_irs">Rights and Roles Matrix of IRS</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Category</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Endpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_irs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">admin_irs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy Store</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST /irs/policies</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get policies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /irs/policies</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Find policies (paged)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /irs/policies/paged</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT /irs/policies/{policyId}</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE /irs/policies/{policyId}</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aspect models</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get aspect models</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /irs/aspectmodels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST /irs/jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /irs/jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /irs/jobs/{jobId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cancel job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT /irs/jobs/{jobId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST /irs/orders</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /irs/orders/{orderId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cancel order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT /irs/orders/{orderId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get batch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /irs/orders/{orderId}/batches/{batchId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environmental- and
Social Standards</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register investigation job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST /ess/bpn/investigations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get investigation job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /ess/bpn/investigations{id}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accept notifications</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST /ess/notification/receive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Legend: x = full access to all resources</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_irs_as_dtr_client">IRS as DTR client</h4>
<div class="paragraph">
<p>The IRS acts as a client for the Digital Twin Registry (DTR), which is secured using OAuth2.0 / Open ID Connect.
The IRS uses client credentials to authenticate requests to the DTR.
Due to this, the IRS account needs to have access to every item in the DTR, unrelated to the permissions of the account calling the IRS API.</p>
</div>
</div>
<div class="sect3">
<h4 id="_irs_as_decentralized_dtr_client">IRS as decentralized DTR client</h4>
<div class="paragraph">
<p>In a decentralized network, IRS uses the EDC client to access the provider DTR.
This way, no authentication, other than the EDC contract negotiation, is needed to access the DTR.</p>
</div>
</div>
<div class="sect3">
<h4 id="_irs_as_edc_client">IRS as EDC client</h4>
<div class="paragraph">
<p>The IRS accesses the Catena-X network via the EDC consumer connector.
This component requires authentication via a Verifiable Credential (VC), which is provided to the EDC via the Managed Identity Wallet.</p>
</div>
<div class="paragraph">
<p>The VC identifies and authenticates the EDC and is used to acquire access permissions for the data transferred via EDC.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_credentials">Credentials</h3>
<div class="paragraph">
<p>Credentials must never be stored in Git!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture_and_design_patterns">Architecture and design patterns</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_dependency_inversion">Dependency inversion</h3>
<div class="paragraph">
<p>For the IRS, we utilize the dependency inversion mechanisms provided by Spring Boot as much as possible.</p>
</div>
<div class="paragraph">
<p>The principle says:</p>
</div>
<div class="paragraph">
<p>High-level modules should not import anything from low-level modules. Both should depend on abstractions (e.g., interfaces).
Abstractions should not depend on details. Details (concrete implementations) should depend on abstractions.</p>
</div>
<div class="paragraph">
<p>Adhering to this, we define clear interfaces between the different domains (e.g. job orchestration and AAS communication) in the IRS and let dependencies be injected by the framework. This improves testability of the classes as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hexagonal_architecture">Hexagonal architecture</h3>
<div class="paragraph">
<p>The hexagonal architecture divides a system into several loosely-coupled interchangeable components, such as the application core, the database, the user interface, test scripts and interfaces with other systems. This approach is an alternative to the traditional layered architecture.</p>
</div>
<div class="paragraph">
<p>For the IRS, this means decoupling the application logic from components like the BLOB store, the REST API controllers or the AAS client connection. With an interface between the parts (so-called port), it is easy to switch to other implementations, e.g. if you want to change the persistence implementation. No changes to the application logic will be necessary.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="architecture.svg" alt="architecture" width="710" height="507">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_under_the_hood_concepts">"Under-the-hood" concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_persistence">Persistence</h3>
<div class="paragraph">
<p>The IRS stores two types of data in a persistent way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Job metadata</p>
</li>
<li>
<p>Job payloads, e.g. AAS shells or submodel data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of this is data is stored in an object store.
The currently used implementation is Minio (Amazon S3 compatible).
This reduces the complexity in storing and retrieving data.
There also is no predefined model for the data, every document can be stored as it is.
The downside of this approach is lack of query functionality, as we can only search through the keys of the entries but not based on the value data.
In the future, another approach or an additional way to to index the data might be required.</p>
</div>
<div class="paragraph">
<p>To let the data survive system restarts, Minio needs to use a persistent volume for the data storage.
A default configuration for this is provided in the Helm charts.</p>
</div>
</div>
<div class="sect2">
<h3 id="_transaction_handling">Transaction handling</h3>
<div class="paragraph">
<p>There currently is no transaction management in the IRS.</p>
</div>
</div>
<div class="sect2">
<h3 id="_session_handling">Session handling</h3>
<div class="paragraph">
<p>There is no session handling in the IRS, access is solely based on bearer tokens, the API is stateless.</p>
</div>
</div>
<div class="sect2">
<h3 id="_communication_and_integration">Communication and integration</h3>
<div class="paragraph">
<p>All interfaces to other systems are using RESTful calls over HTTP(S).
Where central authentication is required, a common OAuth2 provider is used.</p>
</div>
<div class="paragraph">
<p>For outgoing calls, the Spring RestTemplate mechanism is used and separate RestTemplates are created for the different ways of authentication.</p>
</div>
<div class="paragraph">
<p>For incoming calls, we utilize the Spring REST Controller mechanism, annotating the interfaces accordingly and also documenting the endpoints using OpenAPI annotations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exception_and_error_handling">Exception and error handling</h3>
<div class="paragraph">
<p>There are two types of potential errors in the IRS:</p>
</div>
<div class="sect3">
<h4 id="_technical_errors">Technical errors</h4>
<div class="paragraph">
<p>Technical errors occur when there is a problem with the application itself, its configuration or directly connected infrastructure, e.g. the Minio persistence.
Usually, the application cannot solve these problems by itself and requires some external support (manual work or automated recovery mechanisms, e.g. Kubernetes liveness probes).</p>
</div>
<div class="paragraph">
<p>These errors are printed mainly to the application log and are relevant for the healthchecks.</p>
</div>
</div>
<div class="sect3">
<h4 id="_functional_errors">Functional errors</h4>
<div class="paragraph">
<p>Functional errors occur when there is a problem with the data that is being processed or external systems are unavailable and data cannot be sent / fetched as required for the process.
While the system might not be able to provide the required function at that moment, it may work with a different dataset or as soon as the external systems recover.</p>
</div>
<div class="paragraph">
<p>These errors are reported in the Job response and do not directly affect application health.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rules_for_exception_handling">Rules for exception handling</h4>
<div class="sect4">
<h5 id="_throw_or_log_dont_do_both">Throw or log, don&#8217;t do both</h5>
<div class="paragraph">
<p>When catching an exception, either log the exception and handle the problem or rethrow it, so it can be handled at a higher level of the code.
By doing both, an exception might be written to the log multiple times, which can be confusing.</p>
</div>
</div>
<div class="sect4">
<h5 id="_write_own_base_exceptions_for_internal_interfaces">Write own base exceptions for (internal) interfaces</h5>
<div class="paragraph">
<p>By defining a common (checked) base exception for an interface, the caller is forced to handle potential errors, but can keep the logic simple.
On the other hand, you still have the possibility to derive various, meaningful exceptions for different error cases, which can then be thrown via the API.</p>
</div>
<div class="paragraph">
<p>Of course, when using only RuntimeExceptions, this is not necessary - but those can be overlooked quite easily, so be careful there.</p>
</div>
</div>
<div class="sect4">
<h5 id="_central_fallback_exception_handler">Central fallback exception handler</h5>
<div class="paragraph">
<p>There will always be some exception that cannot be handled inside of the code correctly - or it may just have been unforeseen.
A central fallback exception handler is required so all problems are visible in the log and the API always returns meaningful responses.
In some cases, this is as simple as a HTTP 500.</p>
</div>
</div>
<div class="sect4">
<h5 id="_dont_expose_too_much_exception_details_over_api">Dont expose too much exception details over API</h5>
<div class="paragraph">
<p>It&#8217;s good to inform the user, why their request did not work, but only if they can do something about it (HTTP 4xx).
So in case of application problems, you should not expose details of the problem to the caller.
This way, we avoid opening potential attack vectors.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parallelization_and_threading">Parallelization and threading</h3>
<div class="paragraph">
<p>The heart of the IRS is the parallel execution of planned jobs.
As almost each job requires multiple calls to various endpoints, those are done in parallel as well to reduce the total execution time for each job.</p>
</div>
<div class="paragraph">
<p>Tasks execution is orchestrated by the JobOrchestrator class.
It utilizes a central ExecutorService, which manages the number of threads and schedules new Task as they come in.</p>
</div>
</div>
<div class="sect2">
<h3 id="_plausibility_checks_and_validation">Plausibility checks and validation</h3>
<div class="paragraph">
<p>Data validation happens at two points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IRS API: the data sent by the client is validated to match the model defined in the IRS.
If the validation fails, the IRS sends a HTTP 400 response and indicates the problem to the caller.</p>
</li>
<li>
<p>Submodel payload: each time a submodel payload is requested from via EDC, the data is validated against the model defined in the SemanticHub for the matching aspect type.</p>
</li>
<li>
<p>EDC Contract Offer Policy: each time IRS consumes data over the EDC, the policies of the offered contract will be validated.
IDs of so-called "Rahmenverträgen" or Framework-Agreements can be added to the IRS Policy Store to be accepted by the IRS.
If a Contract Offer does not match any of the IDs store in Policy Store, the contract offer will be declined and no data will be consumed.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_policy_store">Policy Store</h3>
<div class="paragraph">
<p>The IRS gives its users the ability to manage, create and delete complex policies containing permissions and constraints in order to obtain the most precise control over access and use of data received from the edc provider.
Policies stored in Policy Store will serve as input with allowed restriction and will be checked against every item from EDC Catalog.</p>
</div>
<div class="paragraph">
<p>The structure of a Policy that can be stored in storage can be easily viewed by using Policy Store endpoints in the published API documentation.
Each policy may contain more than one permission, which in turn consists of constraints linked together by AND or OR relationships.
This model provides full flexibility and control over stored access and use policies.</p>
</div>
</div>
<div class="sect2">
<h3 id="_digital_twin_edc_requirements">Digital Twin / EDC requirements</h3>
<div class="paragraph">
<p>In order to work with the decentral network approach, IRS requires the Digital Twin to contain a <code>"subprotocolBody"</code> in each of the submodelDescriptor endpoints.
This <code>"subprotocolBody"</code> has to contain the <code>"id"</code> of the EDC asset, as well as the <code>"dspEndpoint"</code> of the EDC, separated by a semicolon (e.g. <code>"subprotocolBody": "id=123;dspEndpoint=http://edc.control.plane/api/v1/dsp"</code>).</p>
</div>
<div class="paragraph">
<p>The <code>"dspEndpoint"</code> is used to request the EDC catalog of the dataprovider and the <code>"id"</code> to filter for the exact asset inside this catalog.</p>
</div>
<div class="paragraph">
<p>If the <code>"dspEndpoint"</code> is not present, every available EDC endpoint in DiscoveryService will be queried until a asset with the <code>"id"</code> can be found.</p>
</div>
</div>
<div class="sect2">
<h3 id="_caching">Caching</h3>
<div class="paragraph">
<p>The IRS caches data provided externally to avoid unnecessary requests and reduce execution time.</p>
</div>
<div class="paragraph">
<p>Caching is implemented for the following services:</p>
</div>
<div class="sect3">
<h4 id="_semantics_hub">Semantics Hub</h4>
<div class="paragraph">
<p>Whenever a semantic model schema is requested from the Semantic Hub, it is stored locally until the cache is evicted (configurable).
The IRS can preload configured schema models on startup to reduce on demand call times.</p>
</div>
<div class="paragraph">
<p>Additionally, models can be deployed with the system as a backup to the real Semantic Hub service.</p>
</div>
</div>
<div class="sect3">
<h4 id="_discovery_service">Discovery Service</h4>
<div class="paragraph">
<p>The IRS uses the Discovery Finder in order to find the correct EDC Discovery URL for the type BPN.
This URL is cached locally.</p>
</div>
<div class="paragraph">
<p>When the EDC Discovery is requested to return the EDC connector endpoint URLs for a specific BPN, the results are cached as well.</p>
</div>
<div class="paragraph">
<p>The time to live for both caches can be configured separately as described in the Administration Guide.</p>
</div>
<div class="paragraph">
<p>Further information on Discovery Service can be found in the chapter "System scope and context".</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_discovery_process">Discovery Process</h3>
<div class="sect3">
<h4 id="_digital_twin_registry">Digital Twin Registry</h4>
<div class="paragraph">
<p>The Dataspace Discovery Service handles multiple EDC-Urls received for BPN.
This applies to the following scenarios.</p>
</div>
<div class="sect4">
<h5 id="_scenario_1_one_edc_with_multiple_dtrs">Scenario 1: One EDC with multiple DTRs</h5>
<div class="paragraph">
<p>IRS queries all DTRs for the globalAssetId and will take the first result it gets.
If none of the DTRs return a result, IRS will create a tombstone.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--one-EDC-with-multiple-DTRs.svg" alt="discovery DTR  one EDC with multiple DTRs" width="535" height="478">
</div>
</div>
<div class="paragraph">
<p>Same diagram with a little more detail on IRS side:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--one-EDC-with-multiple-DTRs--detailed.svg" alt="discovery DTR  one EDC with multiple DTRs  detailed" width="904" height="778">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_scenario_2_multiple_edcs_with_one_dtr">Scenario 2: Multiple EDCs with one DTR</h5>
<div class="paragraph">
<p>IRS starts a contract negotiation for all registry contract offers in parallel and queries the DTRs for all successful negotiations.
The first registry which responds with a DT will be the one used by IRS.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--multiple-EDCs-with-one-DTR.svg" alt="discovery DTR  multiple EDCs with one DTR" width="729" height="540">
</div>
</div>
<div class="paragraph">
<p>Same diagram with a little more detail on IRS side:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--multiple-EDCs-with-one-DTR--detailed.svg" alt="discovery DTR  multiple EDCs with one DTR  detailed" width="1091" height="942">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_scenario_3_one_edc_with_one_dtr">Scenario 3: One EDC with one DTR</h5>
<div class="paragraph">
<p>Only one EDC found for BPN and the catalog only contains one offer for the DTR.
IRS will use this registry and will create a tombstone if no DT could be found for the globalAssetId.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--one-EDC-with-one-DTR.svg" alt="discovery DTR  one EDC with one DTR" width="422" height="295">
</div>
</div>
<div class="paragraph">
<p>Same diagram with a little more detail on IRS side:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--one-EDC-with-one-DTR--detailed.svg" alt="discovery DTR  one EDC with one DTR  detailed" width="787" height="494">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_scenario_4_multiple_edcs_with_multiple_dtrs">Scenario 4: Multiple EDCs with multiple DTRs</h5>
<div class="paragraph">
<p>IRS starts a contract negotiation for all the registry offers.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--multiple-EDCs-with-multiple-DTRs.svg" alt="discovery DTR  multiple EDCs with multiple DTRs" width="729" height="627">
</div>
</div>
<div class="paragraph">
<p>Same diagram with a little more detail on IRS side:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--multiple-EDCs-with-multiple-DTRs--detailed.svg" alt="discovery DTR  multiple EDCs with multiple DTRs  detailed" width="1163" height="1454">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_scenario_5_multiple_edcs_with_no_dtrs">Scenario 5: Multiple EDCs with no DTRs</h5>
<div class="paragraph">
<p>IRS starts a contract negotiation for all the registry offers and creates a tombstone since no DTR could be discovered.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--multiple-EDCs-with-no-DTRs.svg" alt="discovery DTR  multiple EDCs with no DTRs" width="497" height="495">
</div>
</div>
<div class="paragraph">
<p>Same diagram with a little more detail on IRS side:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--multiple-EDCs-with-no-DTRs--detailed.svg" alt="discovery DTR  multiple EDCs with no DTRs  detailed" width="861" height="824">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_special_scenario_same_dt_in_multiple_dtrs">Special Scenario: Same DT in multiple DTRs</h5>
<div class="paragraph">
<p>IRS will use all registries to query for the globalAssetId and takes the first result which is returned.
If no DT could be found in any of the DTRs, IRS will create a tombstone.</p>
</div>
</div>
<div class="sect4">
<h5 id="_special_scenario_multiple_dts_with_the_same_globalassetid_in_one_dtr">Special Scenario: Multiple DTs (with the same globalAssetId) in one DTR</h5>
<div class="paragraph">
<p>IRS uses the <code>/query</code> endpoint of the DTR to get the DT id based on the globalAssetId.
If more than one id is present for a globalAssetId, IRS will use the first of the list.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-DTR--multiple-DTs-with-the-same-globalAssedId-in-one-DTR.svg" alt="discovery DTR  multiple DTs with the same globalAssedId in one DTR" width="225" height="191">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_edc">EDC</h4>
<div class="paragraph">
<p>EndpointDataReferenceStorage is in-memory local storage that holds records (EndpointDataReferences) by either assetId or contractAgreementId.</p>
</div>
<div class="paragraph">
<p>When EDC gets EndpointDataReference describing endpoint serving data it uses EndpointDataReferenceStorage and query it by assetId.
This allows reuse of already existing EndpointDataReference if it is present, valid, and it&#8217;s token is not expired, rather than starting whole new contract negotiation process.</p>
</div>
<div class="paragraph">
<p>In case token is expired the process is also shortened.
We don&#8217;t have to start new contract negotiation process, since we can obtain required contractAgreementId from present authCode.
This improves request processing time.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-process-edc.svg" alt="discovery process edc" width="1253" height="535">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_development_concepts">Development concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_build_test_deploy">Build, test, deploy</h3>
<div class="paragraph">
<p>The IRS is built using <a href="https://maven.apache.org/">Apache Maven</a> and utilizes all the standard concepts of it.
Test execution is part of the build process and a minimum test coverage of 80% is enforced.</p>
</div>
<div class="paragraph">
<p>The project setup contains a multi-module Maven build.
Commonly used classes (like the IRS data model) should be extracted
into a separate submodule and reused across the project.
However, this is not a "one-size-fits-all" solution.
New submodules should be created with care and require a review by the team.</p>
</div>
<div class="paragraph">
<p>The Maven build alone only leads up to the JAR artifact of the IRS.
To create Docker images, the Docker build feature is used.
This copies all resources into a builder image,
builds the software and creates a final Docker image at the end that can then be deployed.</p>
</div>
<div class="paragraph">
<p>Although the Docker image can be deployed in various ways, the standard solution are the provided Helm charts,
which describe the required components as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="_code_generation">Code generation</h3>
<div class="paragraph">
<p>There are two methods of code generation in the IRS:</p>
</div>
<div class="sect3">
<h4 id="_lombok">Lombok</h4>
<div class="paragraph">
<p>The <a href="https://projectlombok.org/">Lombok</a> library is heavily used to generate boilerplate code
(like Constructors, Getters, Setters, Builders&#8230;&#8203;).
This way, code can be written faster and this boilerplate code is excluded from test coverage,
which keeps the test base lean.</p>
</div>
</div>
<div class="sect3">
<h4 id="_swagger_openapi">Swagger / OpenAPI</h4>
<div class="paragraph">
<p>The API uses <a href="https://www.openapis.org/">OpenAPI</a> annotations to describe the endpoints with all necessary information.
The annotations are then used to automatically generate the OpenAPI specification file,
which can be viewed in the Swagger UI that is deployed with the application.</p>
</div>
<div class="paragraph">
<p>The generated OpenAPI specification file is automatically compared to a fixed,
stored version of it to avoid unwanted changes of the API (see <code>IrsApplicationTests.generatedOpenApiMatchesContract</code>).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_migration">Migration</h3>
<div class="paragraph">
<p>There currently is no data migration mechanism for the IRS.
In case the model of the persisted data (Jobs) changes, data is dropped and Jobs will need to be recreated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configurability">Configurability</h3>
<div class="paragraph">
<p>The IRS utilizes the configuration mechanism provided by <a href="https://spring.io/projects/spring-boot">Spring Boot.</a>
Configuration properties can be defined in the file <code>src/main/resources/application.yml</code></p>
</div>
<div class="paragraph">
<p>For local testing purposes, there is an additional configuration file called <code>application-local.yml</code>.
Values can be overridden there to support the local dev environment.</p>
</div>
<div class="paragraph">
<p>Other profiles should be avoided.
Instead, the configuration can be overwritten using the Spring Boot externalized configuration mechanism.
The operator must have total control over the configuration of the IRS.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operational_concepts">Operational concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_administration">Administration</h3>
<div class="sect3">
<h4 id="_configuration">Configuration</h4>
<div class="paragraph">
<p>The IRS can be configured using two mechanisms:</p>
</div>
<div class="sect4">
<h5 id="_application_yml">application.yml</h5>
<div class="paragraph">
<p>If you build the IRS yourself, you can modify the application.yml config that is shipped with the IRS.
This file contains all possible config entries for the application.
Once the Docker image has been built, these values can only be overwritten using the
Spring Boot externalized configuration mechanism,
e.g. by mounting a config file in the right path or using environment variables.</p>
</div>
</div>
<div class="sect4">
<h5 id="_helm_chart">Helm Chart</h5>
<div class="paragraph">
<p>The most relevant config properties are exposed as environment variables and must be set
in the <a href="https://helm.sh/">Helm</a> chart so the application can run at all.
Check the IRS Helm chart in Git for all available variables.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_disaster_recovery">Disaster-Recovery</h3>
<div class="sect3">
<h4 id="_ephemeral_components">Ephemeral components</h4>
<div class="paragraph">
<p>All components in the IRS deployment not listed in the persistent components section below are considered ephemeral
and are easily replaced in a disaster scenario.
All deployment components are described using Helm charts,
which can be used to restore the deployment with the Docker images.
Should the Docker images go missing, they can be restored by executing the build pipelines
for the corresponding version tag of the component.</p>
</div>
</div>
<div class="sect3">
<h4 id="_persistent_components">Persistent components</h4>
<div class="paragraph">
<p>These components utilize data persistence, which needs to be backed up separately by the operator.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Minio persistent volume</strong>: Contains the stored Job information. In case of data loss, Jobs can be started again to retrieve the data from the network.</p>
</li>
<li>
<p><strong>Prometheus persistent volume</strong>: Contains the monitoring data of the IRS. In case of data loss, no analysis can be done for past timeframes.</p>
</li>
<li>
<p><strong>Vault secrets</strong>: In case of data loss, the credentials stored in the Vault need to be recreated manually. See the deployment view for an overview.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scaling">Scaling</h3>
<div class="paragraph">
<p>If the number of consumers raises, the IRS can be scaled up by using more resources for the Deployment Pod.
Those resources can be used to utilize more parallel threads to handle Job execution.</p>
</div>
</div>
<div class="sect2">
<h3 id="_clustering">Clustering</h3>
<div class="paragraph">
<p>The IRS can run in clustered mode, as each running job is only present in one pod at a time.
Note: as soon as a resume feature is implemented, this needs to be addressed here.</p>
</div>
</div>
<div class="sect2">
<h3 id="_logging">Logging</h3>
<div class="paragraph">
<p>Logs are being written directly to stdout and are picked up by the cluster management.</p>
</div>
</div>
<div class="sect2">
<h3 id="_monitoring">Monitoring</h3>
<div class="paragraph">
<p>The application can be monitored using <a href="https://prometheus.io/">Prometheus</a> and <a href="https://grafana.com/">Grafana</a>.
Both systems are defined in the Helm charts with a default setup.
A number of Grafana dashboards are deployed automatically, to display data about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pod / JVM resources</p>
</li>
<li>
<p>API metrics</p>
</li>
<li>
<p>Functional information about IRS Jobs</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_concepts">Testing concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_how_to_test_a_feature">How to test a feature</h3>
<div class="paragraph">
<p>Features in IRS are tested by unit, integration and end-to-end tests.
We maintain a unit and integration tests coverage of at lease 80% which has to be kept up for new features.</p>
</div>
<div class="paragraph">
<p>To test integration with the whole IRS flow, we provide <a href="https://github.com/eclipse-tractusx/item-relationship-service/blob/main/irs-api/src/test/java/org/eclipse/tractusx/irs/IrsWireMockIntegrationTest.java">Wiremock integration tests</a> where all third-party services are mocked.
This test can be extended with your desired configuration to maintain full coverage.</p>
</div>
<div class="paragraph">
<p>End-to-end tests are conducted via <a href="https://taverntesting.github.io/">Tavern</a> and <a href="https://cucumber.io/">Cucumber</a>.</p>
</div>
<div class="paragraph">
<p>Cucumber feature files are located in <a href="https://github.com/eclipse-tractusx/item-relationship-service/tree/main/irs-cucumber-tests/src/test/resources/org/eclipse/tractusx/irs/cucumber/features">irs-cucumber-tests/src/test/resources/org/eclipse/tractusx/irs/cucumber/features</a> and executed with a GitHub workflow <a href="https://github.com/eclipse-tractusx/item-relationship-service/blob/main/.github/workflows/cucumber-integration-test-UMBRELLA.yaml">cucumber-integration-test-UMBRELLA.yaml</a>.</p>
</div>
<div class="paragraph">
<p>Tavern Tests are located in <a href="https://github.com/eclipse-tractusx/item-relationship-service/tree/main/local/testing/api-tests">local/testing/api-tests</a> and executed with a GitHub workflow <a href="https://github.com/eclipse-tractusx/item-relationship-service/blob/main/.github/workflows/tavern-UMBRELLA.yml">tavern-UMBRELLA.yml</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_umbrella">Umbrella</h3>
<div class="paragraph">
<p>The <a href="https://github.com/eclipse-tractusx/tractus-x-umbrella">umbrella chart</a> provides a pre-configured catena-x network which includes all necessary components for the IRS to work.</p>
</div>
<div class="paragraph">
<p>For IRS this includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Central Idp</p>
</li>
<li>
<p>Edc Provider</p>
<div class="ulist">
<ul>
<li>
<p>Digital Twin Registry</p>
</li>
<li>
<p>Submodel Backend</p>
</li>
<li>
<p>EDC</p>
</li>
<li>
<p>Vault</p>
</li>
</ul>
</div>
</li>
<li>
<p>EDC Consumer</p>
<div class="ulist">
<ul>
<li>
<p>EDC</p>
</li>
<li>
<p>Vault</p>
</li>
</ul>
</div>
</li>
<li>
<p>Discovery Service</p>
</li>
<li>
<p>EDC Discovery *</p>
</li>
<li>
<p>IATP *</p>
</li>
<li>
<p>BDRS</p>
</li>
<li>
<p>Semantic Hub</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Services marked with * are currently mocked, since there is no FOSS-Component available for IATP/DIM and the configuration and data seeding for EDC Discovery is not possible at the moment.</p>
</div>
<div class="paragraph">
<p>These Service are used together with the IRS Helm Chart to provide a E2E Testing Infrastructure which can be spun up directly in a GitHub Workflow to execute E2E Tests against.</p>
</div>
<div class="paragraph">
<p>The action <a href="https://github.com/eclipse-tractusx/item-relationship-service/blob/main/.github/actions/setup-umbrella-env/action.yaml" class="bare">https://github.com/eclipse-tractusx/item-relationship-service/blob/main/.github/actions/setup-umbrella-env/action.yaml</a> creates this environment and seeds Testdata for IRS use-cases directly to the EDC Provider components.
After Umbrella setup and seeding, the IRS docker image is built based on the branch, the workflow is run from, and the IRS helm chart from the same branch is installed.
This ensures, that features on branches can be tested as well.</p>
</div>
<div class="paragraph">
<p>The workflows <a href="https://github.com/eclipse-tractusx/item-relationship-service/blob/main/.github/workflows/tavern-UMBRELLA.yml">tavern-UMBRELLA.yaml</a> and <a href="https://github.com/eclipse-tractusx/item-relationship-service/blob/main/.github/workflows/cucumber-integration-test-UMBRELLA.yaml">cucumber-integration-test-UMBRELLA.yaml</a> use the action to execute the tests.
Test results are automatically added to the workflow summary and in case of the cucumber tests uploaded to the <a href="https://reports.cucumber.io/report-collections/b82bcadd-0d19-41c4-ae1a-c623e259c36f">IRS Cucumber Report</a></p>
</div>
<div class="paragraph">
<p>Due to limitations in the IATP mock, the only way of using multiple BPNs in the test data is to spin up multiple EDC provider instances.
However, the chart is used inside GitHub Workflows, so compute resources are limited.
For this reason, the IRS test data was changed to include only data pointing to a single BPN.</p>
</div>
<div class="paragraph">
<p>For instructions on how to use the Umbrella Chart locally, see <a href="https://github.com/eclipse-tractusx/item-relationship-service/blob/main/INSTALL.md#local-installation-with-umbrella">INSTALL.md</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_api_documentation">API Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document provides an overview of the API endpoints, their supported HTTP methods, visibility status, and the reasons for their current or future public accessibility.</p>
</div>
<div class="sect2">
<h3 id="_table_of_contents">Table of Contents</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#_ess_endpoints">ESS Endpoints</a></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="#_investigations">Investigations</a></p>
</li>
<li>
<p><a href="#_notifications">Notifications</a></p>
</li>
</ol>
</div>
</li>
<li>
<p><a href="#_irs_endpoints">IRS Endpoints</a></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="#_aspect_models">Aspect Models</a></p>
</li>
<li>
<p><a href="#_jobs">Jobs</a></p>
</li>
<li>
<p><a href="#_orders">Orders</a></p>
</li>
<li>
<p><a href="#_policies">Policies</a></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_ess_endpoints">ESS Endpoints</h3>
<div class="sect3">
<h4 id="_investigations">Investigations</h4>
<div class="sect4">
<h5 id="_post_essbpninvestigations">POST <code>/ess/bpn/investigations</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Create new investigations for a Business Partner Number (BPN).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_get_essbpninvestigationsid">GET <code>/ess/bpn/investigations/{id}</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Retrieve a specific investigation by ID.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_notifications">Notifications</h4>
<div class="sect4">
<h5 id="_post_essnotificationreceive">POST <code>/ess/notification/receive</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Receive notifications from other instances.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_irs_endpoints">IRS Endpoints</h3>
<div class="sect3">
<h4 id="_aspect_models">Aspect Models</h4>
<div class="sect4">
<h5 id="_get_irsaspectmodels">GET <code>/irs/aspectmodels</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Retrieve a list of aspect models.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jobs">Jobs</h4>
<div class="sect4">
<h5 id="_get_irsjobs">GET <code>/irs/Jobs</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Retrieve a list of jobs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_post_irsjobs">POST <code>/irs/Jobs</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Create a new job.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_get_irsjobsid">GET <code>/irs/jobs/{id}</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Retrieve a specific job by ID.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_put_irsjobsid">PUT <code>/irs/jobs/{id}</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Update a specific job by ID.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_orders">Orders</h4>
<div class="sect4">
<h5 id="_post_irsessorders">POST <code>/irs/ess/orders</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Create ESS orders in IRS.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_post_irsorders">POST <code>/irs/orders</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Create new orders.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_get_irsordersorderid">GET <code>/irs/orders/{orderId}</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Retrieve a specific order by ID.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_put_irsordersorderid">PUT <code>/irs/orders/{orderId}</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Update a specific order by ID.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_get_irsordersorderidbatchesbatchid">GET <code>/irs/orders/{orderId}/batches/{batchId}</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Retrieve a specific batch within an order.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_policies">Policies</h4>
<div class="sect4">
<h5 id="_get_irspolicies">GET <code>/irs/policies</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Retrieve a list of policies.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_put_irspolicies">PUT <code>/irs/policies</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Update existing policies.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_post_irspolicies">POST <code>/irs/policies</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Create new policies.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_get_irspoliciesattributesfield">GET <code>/irs/policies/attributes/{field}</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Retrieve policy attributes for a specific field.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_get_irspoliciespaged">GET <code>/irs/policies/paged</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Retrieve policies with pagination.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_delete_irspoliciespolicyid">DELETE <code>/irs/policies/{policyId}</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Delete a specific policy by ID.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="_delete_irspoliciespolicyidbpnlbpnl">DELETE <code>/irs/policies/{policyId}/bpnl/{bpnl}</code></h5>
<div class="paragraph">
<p><strong>Description</strong>: Delete a policy&#8217;s BPNL association.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Visibility</strong>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Current: Public</p>
</li>
<li>
<p>Future: Public</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Reason for visibility</strong>: Is accessed from other instances.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-04-29 10:22:30 UTC
</div>
</div>
</body>
</html>